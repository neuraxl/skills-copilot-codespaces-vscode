<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuraX-Ultime : Simulation Neuronale Évoluée</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        /* Custom styles for the selected vibrant palette - "Energetic & Playful" (Yellow, Teal, Purple) */
        :root {
            --color-primary: #00CED1; /* Teal */
            --color-secondary: #FFD700; /* Yellow */
            --color-accent: #8A2BE2; /* Purple */
            --color-text-dark: #333;
            --color-text-light: #fefefe;
            --color-bg-light: #f8f8f8;
            --color-bg-dark: #2d3748; /* For darker elements like sidebar */
        }
        body {
            background-color: var(--color-bg-light);
            color: var(--color-text-dark);
            overflow-x: hidden; /* Prevent horizontal scroll */
        }
        .header-bg {
            background-color: var(--color-primary);
        }
        .sidebar {
            background-color: var(--color-bg-dark); /* Darker background for sidebar */
            width: 250px;
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            z-index: 100;
        }
        .sidebar.open {
            transform: translateX(0);
        }
        @media (min-width: 768px) {
            .sidebar {
                transform: translateX(0);
            }
            .main-content-area {
                margin-left: 250px; /* Adjust main content to sidebar width */
            }
        }

        .nav-item {
            color: var(--color-text-light);
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        .nav-item.active {
            background-color: var(--color-accent);
            font-weight: bold;
        }
        .btn-primary {
            background-color: var(--color-primary);
            color: var(--color-text-light);
            transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
        }
        .btn-primary:hover {
            background-color: #00BFFF; /* A slightly lighter teal */
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 206, 209, 0.3);
        }
        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 206, 209, 0.2);
        }
        .btn-secondary {
            background-color: #e2e8f0; /* Gray-200 */
            color: var(--color-text-dark);
            transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
        }
        .btn-secondary:hover {
            background-color: #cbd5e0; /* Gray-300 */
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(170, 180, 190, 0.3);
        }
        .btn-secondary:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(170, 180, 190, 0.2);
        }
        .progress-bar-fill {
            background-color: var(--color-accent);
            transition: width 0.3s ease-out;
        }
        .modal {
            background-color: rgba(0, 0, 0, 0.7);
            transition: opacity 0.3s ease-out;
        }
        .modal-content {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        .modal.hidden .modal-content {
            transform: translateY(-20px);
            opacity: 0;
        }
        .modal:not(.hidden) .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .toast-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
        }
        .toast {
            background-color: var(--color-primary);
            color: var(--color-text-light);
            animation: slideInFromRight 0.5s ease-out forwards;
            opacity: 0;
            transform: translateX(100%);
        }
        .toast.success { background-color: #2ecc71; }
        .toast.error { background-color: #e74c3c; }
        .toast.info { background-color: #3498db; }
        .toast.fade-out {
            animation: slideOutToRight 0.5s ease-in forwards;
        }

        @keyframes slideInFromRight {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOutToRight {
            0% { transform: translateX(0); opacity: 1; }
            100% { transform: translateX(100%); opacity: 0; }
        }

        .chat-message.user {
            background-color: var(--color-accent);
            color: var(--color-text-light);
            align-self: flex-end;
            border-bottom-right-radius: 0;
            animation: fadeInMessage 0.3s ease-out;
        }
        .chat-message.ai {
            background-color: var(--color-secondary);
            color: var(--color-text-dark);
            align-self: flex-start;
            border-bottom-left-radius: 0;
            animation: fadeInMessage 0.3s ease-out;
        }
        @keyframes fadeInMessage {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .thinking-indicator {
            display: flex;
            justify-content: flex-start;
            margin-bottom: 0.5rem;
        }
        .thinking-dot {
            width: 8px;
            height: 8px;
            background-color: #ccc;
            border-radius: 50%;
            margin: 0 2px;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .thinking-dot:nth-child(1) { animation-delay: -0.32s; }
        .thinking-dot:nth-child(2) { animation-delay: -0.16s; }
        .thinking-dot:nth-child(3) { animation-delay: 0s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        .voice-active-dot {
            width: 10px;
            height: 10px;
            background-color: #2ecc71; /* Green for active */
            border-radius: 50%;
            display: inline-block;
            animation: pulse-voice 1.5s infinite ease-in-out;
        }
        @keyframes pulse-voice {
            0% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(46, 204, 113, 0); }
            100% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
        }
        /* Canvas container styling for responsiveness */
        .canvas-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 Aspect Ratio (height / width * 100%) */
            overflow: hidden;
            background-color: #f8f8f8;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 800px; /* Max width for readability on large screens */
            margin-left: auto;
            margin-right: auto;
            cursor: crosshair; /* Indicate clickable area */
        }
        .canvas-container canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
        }
        /* Styles for section content management */
        .content-section {
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s ease-out;
        }
        .content-section.active {
            display: block; /* Shown when active */
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Neuron Info Tooltip */
        #neuronInfoTooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.75);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            pointer-events: none; /* Allows clicks to pass through to canvas */
            white-space: nowrap;
            z-index: 50;
            opacity: 0;
            transition: opacity 0.2s ease-out;
            transform: translate(-50%, -100%); /* Position above cursor */
        }
        #neuronInfoTooltip.visible {
            opacity: 1;
        }

        /* System Health Bar */
        .health-bar-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            height: 15px;
            overflow: hidden;
            margin-top: 8px;
        }
        .health-bar-fill {
            height: 100%;
            background-color: #2ecc71; /* Green */
            transition: width 0.3s ease-out, background-color 0.3s ease-out;
        }
        .health-bar-fill.low { background-color: #e74c3c; /* Red */ }
        .health-bar-fill.medium { background-color: #f39c12; /* Orange */ }

        /* Configuration sliders styling for visual feedback */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
            border-radius: 5px;
        }
        input[type="range"]:hover {
            opacity: 1;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--color-accent);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        input[type="range"]::-webkit-slider-thumb:hover {
            background: #ab47bc; /* Slightly darker purple */
            transform: scale(1.1);
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--color-accent);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        input[type="range"]::-moz-range-thumb:hover {
            background: #ab47bc;
            transform: scale(1.1);
        }
    </style>
</head>
<body class="flex flex-col md:flex-row min-h-screen">
    <aside id="sidebar" class="sidebar fixed inset-y-0 left-0 w-64 p-6 md:relative md:transform-none shadow-lg md:shadow-none transition-transform duration-300 ease-in-out flex flex-col items-center z-50">
        <div class="mb-8 text-center">
            <h2 class="text-3xl font-bold text-white mb-2">NeuraX-Ultime</h2>
            <p class="text-sm text-gray-300">Simulation de Réseau Neuronal</p>
        </div>

        <nav class="flex-grow w-full">
            <ul>
                <li class="mb-2">
                    <a href="#overview" class="nav-item flex items-center p-3 rounded-lg text-lg active" data-target-content="overviewContent">
                        <span class="mr-3">📊</span> Vue d'ensemble
                    </a>
                </li>
                <li class="mb-2">
                    <a href="#stats" class="nav-item flex items-center p-3 rounded-lg text-lg" data-target-content="statsContent">
                        <span class="mr-3">📈</span> Statistiques
                    </a>
                </li>
                <li class="mb-2">
                    <a href="#config" class="nav-item flex items-center p-3 rounded-lg text-lg" data-target-content="configContent">
                        <span class="mr-3">⚙️</span> Configuration
                    </a>
                </li>
                <li class="mb-2">
                    <a href="#brainFunctions" class="nav-item flex items-center p-3 rounded-lg text-lg" data-target-content="brainFunctionsContent">
                        <span class="mr-3">🧠</span> Fonctions du Cerveau
                    </a>
                </li>
                <li class="mb-2">
                    <a href="#externalServices" class="nav-item flex items-center p-3 rounded-lg text-lg" data-target-content="externalServicesContent">
                        <span class="mr-3">🔗</span> Extensions & Services
                    </a>
                </li>
                <li class="mb-2">
                    <a href="#logs" class="nav-item flex items-center p-3 rounded-lg text-lg" data-target-content="logsContent">
                        <span class="mr-3">📜</span> Journal
                    </a>
                </li>
            </ul>
        </nav>

        <div class="w-full mt-auto pt-6 border-t border-gray-700 text-sm text-gray-400 text-center">
            &copy; 2025 NeuraX Systems
        </div>
    </aside>

    <main class="main-content-area flex-grow p-4 md:p-8 relative">
        <button id="menuToggle" class="md:hidden fixed top-4 left-4 z-50 p-3 bg-gray-800 text-white rounded-lg shadow-lg">
            ☰
        </button>

        <div class="container mx-auto">
            <h1 class="text-4xl font-extrabold text-gray-800 mb-8 text-center">Bienvenue sur NeuraX-Ultime</h1>

            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Contrôle Système</h2>
                <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4">
                    <button id="startBtn" class="btn-primary py-3 px-6 rounded-full text-lg font-semibold shadow-lg hover:shadow-xl transition duration-300 ease-in-out flex-grow">
                        Démarrer le Système NeuraX
                    </button>
                    <button id="deactivateBtn" class="btn-secondary py-3 px-6 rounded-full text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out flex-grow hidden">
                        Désactiver le Système
                    </button>
                </div>
                <div class="mt-4">
                    <p class="text-sm text-gray-600">Santé du Système: <span id="systemHealthText" class="font-semibold text-primary">N/A</span></p>
                    <div class="health-bar-container">
                        <div id="systemHealthBar" class="health-bar-fill" style="width: 0%;"></div>
                    </div>
                </div>
            </div>

            <div id="contentWrapper">
                <section id="overviewContent" class="content-section active grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-md flex flex-col">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Visualisation du Réseau</h2>
                        <div class="canvas-container flex-grow relative">
                            <canvas id="neuralCanvas"></canvas>
                            <div id="neuronInfoTooltip" class="hidden"></div>
                        </div>
                        <div class="mt-4 text-sm text-gray-600 text-center">
                            <p>Le réseau s'adapte et évolue en temps réel. **Cliquez pour ajouter des neurones !**</p>
                            <p>Nb. Neurones: <span id="neuronCount" class="font-semibold text-primary">0</span> |
                                Nb. Synapses: <span id="synapseCount" class="font-semibold text-primary">0</span></p>
                            <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                                <div id="replicationProgress" class="progress-bar-fill h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Progression de la Réplication</p>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-lg shadow-md flex flex-col">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Interface de Communication (IA)</h2>
                        <div id="chatBody" class="flex-grow bg-gray-50 p-4 rounded-lg overflow-y-auto mb-4 custom-scrollbar" style="max-height: 400px; min-height: 200px;">
                            </div>
                        <div class="flex items-center space-x-3">
                            <input type="text" id="chatInput" placeholder="Posez une question à NeuraX..." class="flex-grow p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                            <button id="sendBtn" class="btn-primary p-3 rounded-lg shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                <span class="mr-2">🚀</span> Envoyer
                            </button>
                            <button id="voiceBtn" class="p-3 bg-gray-200 rounded-lg shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                <span class="text-lg">🎙️</span>
                                <span class="voice-active-dot hidden"></span>
                            </button>
                        </div>
                    </div>
                </section>

                <section id="statsContent" class="content-section">
                    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Statistiques du Réseau</h2>
                        <p class="text-gray-600 mb-4">Aperçu des métriques clés du réseau neuronal en temps réel.</p>
                        <div id="statsReport" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700">
                            <p><strong>Comptage des neurones :</strong> <span id="statNeuronCount">--</span></p>
                            <p><strong>Comptage des connexions :</strong> <span id="statConnectionCount">--</span></p>
                            <p><strong>Neurones actifs :</strong> <span id="statActiveNeurons">--</span></p>
                            <p><strong>Énergie moyenne :</strong> <span id="statAverageEnergy">--</span></p>
                            <p><strong>Densité du réseau :</strong> <span id="statNetworkDensity">--</span></p>
                            <p><strong>Motifs reconnus :</strong> <span id="statRecognizedPatterns">--</span></p>
                            <p><strong>Taille de la mémoire :</strong> <span id="statMemorySize">--</span></p>
                            <p><strong>État du système :</strong> <span id="statSystemStatus">--</span></p>
                            <p class="md:col-span-2"><strong>Dernière mise à jour :</strong> <span id="statTimestamp">--</span></p>
                        </div>
                        <button id="refreshStatsBtn" class="btn-primary py-2 px-4 rounded-lg mt-6">Rafraîchir les Statistiques</button>
                    </div>
                </section>

                <section id="configContent" class="content-section">
                    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Configuration du Réseau</h2>
                        <p class="text-gray-600 mb-4">Ajustez les paramètres du réseau en temps réel. Les changements sont appliqués automatiquement.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="configMaxNeurons" class="block text-gray-700 font-semibold mb-2">Nombre Max. de Neurones:</label>
                                <input type="range" id="configMaxNeurons" min="100" max="1000" value="300" class="w-full accent-primary">
                                <p class="text-sm text-gray-600 mt-1">Actuel: <span id="currentMaxNeurons">300</span></p>
                            </div>
                            <div>
                                <label for="configNeuronSpeed" class="block text-gray-700 font-semibold mb-2">Vitesse des Neurones:</label>
                                <input type="range" id="configNeuronSpeed" min="0.1" max="2.0" step="0.1" value="0.3" class="w-full accent-primary">
                                <p class="text-sm text-gray-600 mt-1">Actuel: <span id="currentNeuronSpeed">0.3</span></p>
                            </div>
                            <div>
                                <label for="configGrowthRate" class="block text-gray-700 font-semibold mb-2">Taux de Croissance (par 5s):</label>
                                <input type="range" id="configGrowthRate" min="0" max="100" value="15" class="w-full accent-primary">
                                <p class="text-sm text-gray-600 mt-1">Actuel: <span id="currentGrowthRate">15</span></p>
                            </div>
                            <div>
                                <label for="configConnectionDistance" class="block text-gray-700 font-semibold mb-2">Distance de Connexion:</label>
                                <input type="range" id="configConnectionDistance" min="100" max="400" value="180" class="w-full accent-primary">
                                <p class="text-sm text-gray-600 mt-1">Actuel: <span id="currentConnectionDistance">180</span></p>
                            </div>
                            <div>
                                <label for="configLifespanFactor" class="block text-gray-700 font-semibold mb-2">Facteur Durée de Vie Neurone:</label>
                                <input type="range" id="configLifespanFactor" min="100" max="5000" value="1000" class="w-full accent-primary">
                                <p class="text-sm text-gray-600 mt-1">Actuel: <span id="currentLifespanFactor">1000</span></p>
                            </div>
                            <div>
                                <label for="configMutationRate" class="block text-gray-700 font-semibold mb-2">Taux de Mutation (%):</label>
                                <input type="range" id="configMutationRate" min="0" max="0.1" step="0.001" value="0.02" class="w-full accent-primary">
                                <p class="text-sm text-gray-600 mt-1">Actuel: <span id="currentMutationRate">0.02</span></p>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="brainFunctionsContent" class="content-section">
                    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Fonctions du Cerveau NeuraX</h2>
                        <p class="text-gray-600 mb-6">Interagissez directement avec les fonctions fondamentales du réseau neuronal.</p>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <button id="brainFuncActivateBtn" class="btn-primary py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                Activer le Réseau
                            </button>
                            <button id="brainFuncDeactivateBtn" class="btn-secondary py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                Désactiver le Réseau
                            </button>
                            <button id="brainFuncAddNeuronBtn" class="btn-primary py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                Ajouter un Neurone
                            </button>
                            <button id="brainFuncClearMemoryBtn" class="btn-secondary py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                Vider la Mémoire des Motifs
                            </button>
                            <button id="brainFuncGoToStatsBtn" class="btn-primary py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                Voir les Statistiques
                            </button>
                            <button id="brainFuncGoToConfigBtn" class="btn-secondary py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out">
                                Accéder à la Configuration
                            </button>
                        </div>
                    </div>
                </section>

                <section id="externalServicesContent" class="content-section">
                    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Extensions & Services Externes</h2>
                        <p class="text-gray-600 mb-6">Explorez comment NeuraX-Ultime pourrait interagir avec des systèmes externes (intégrations conceptuelles).</p>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google">
                                <span class="mr-2">🌐</span> Google
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Gemini">
                                <span class="mr-2">✨</span> Gemini (LLM)
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Grok">
                                <span class="mr-2">💡</span> Grok (LLM)
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Ask">
                                <span class="mr-2">❓</span> Ask (Moteur de Recherche)
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Cloud AI">
                                <span class="mr-2">☁️</span> Cloud AI (GCP)
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Gamma AI">
                                <span class="mr-2">⚛️</span> Gamma AI
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google Lens">
                                <span class="mr-2">📸</span> Google Lens
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google Home">
                                <span class="mr-2">🏠</span> Google Home
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google Authenticator">
                                <span class="mr-2">🔐</span> Google Authenticator
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google Analytics">
                                <span class="mr-2">📊</span> Google Analytics
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google One">
                                <span class="mr-2">☁️</span> Google One
                            </button>
                            <button class="btn-secondary py-3 px-4 rounded-lg text-base font-semibold shadow-md hover:shadow-lg transition duration-300 ease-in-out external-service-btn" data-service="Google Go">
                                <span class="mr-2">🔍</span> Google Go
                            </button>
                        </div>
                    </div>
                </section>

                <section id="logsContent" class="content-section">
                    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Journal d'Activité du Réseau</h2>
                        <div id="logBody" class="bg-gray-50 p-4 rounded-lg h-96 overflow-y-auto custom-scrollbar text-sm text-gray-800 font-mono">
                            <p class="text-gray-500"><em>Le journal affichera l'activité du réseau...</em></p>
                        </div>
                        <button id="clearLogsBtn" class="btn-secondary py-2 px-4 rounded-lg mt-4">Effacer le Journal</button>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <div id="activationModal" class="modal fixed inset-0 flex items-center justify-center hidden">
        <div class="modal-content bg-white p-8 rounded-lg shadow-2xl max-w-sm w-full text-center">
            <h3 class="text-xl font-bold mb-4">Activation du Système NeuraX</h3>
            <p class="mb-4">Choisissez un niveau d'initialisation pour le réseau (influence le taux de croissance).</p>
            <input type="range" id="activationLevel" min="1" max="100" value="50" class="w-full accent-primary">
            <p class="text-sm text-gray-600 mt-1">Niveau: <span id="currentActivationLevel">50</span>%</p>

            <div class="flex justify-end space-x-4 mt-6">
                <button id="cancelActivation" class="btn-secondary py-2 px-4 rounded-lg">Annuler</button>
                <button id="confirmActivation" class="btn-primary py-2 px-4 rounded-lg">Confirmer</button>
            </div>
        </div>
    </div>

    <div id="toastContainer" class="toast-container space-y-3"></div>

    <script>
        // Configuration avancée du réseau neural
        const neuralConfig = {
            neurons: {
                count: 0,
                maxCount: 300,
                baseSize: 2,
                activeSize: 4,
                colors: ['#3498db', '#9b59b6', '#2ecc71'], // Blue, Purple, Green
                speed: 0.3, // Movement speed
                lifespanFactor: 1000, // How long neurons "live"
                mutationRate: 0.02 // Chance of mutation on replication
            },
            synapses: {
                color: '#ccc',
                width: 1,
                activeWidth: 2,
                opacity: 0.1,
                activeOpacity: 0.5
            },
            growthRate: 15, // Neurons added every 5 seconds
            connectionDistance: 180, // Max distance for connections
            systemHealth: 100, // Initial system health
            isActive: false, // System operational status
            replicationProgress: 0 // Progress towards next replication event
        };

        // DOM Elements
        const sidebar = document.getElementById('sidebar');
        const menuToggle = document.getElementById('menuToggle');
        const navItems = document.querySelectorAll('.nav-item');
        const contentSections = document.querySelectorAll('.content-section');
        const startBtn = document.getElementById('startBtn');
        const deactivateBtn = document.getElementById('deactivateBtn');
        const systemHealthText = document.getElementById('systemHealthText');
        const systemHealthBar = document.getElementById('systemHealthBar');
        const neuralCanvas = document.getElementById('neuralCanvas');
        const neuronInfoTooltip = document.getElementById('neuronInfoTooltip');
        const neuronCountSpan = document.getElementById('neuronCount');
        const synapseCountSpan = document.getElementById('synapseCount');
        const replicationProgress = document.getElementById('replicationProgress');
        const chatBody = document.getElementById('chatBody');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const voiceBtn = document.getElementById('voiceBtn');
        const voiceActiveDot = document.querySelector('.voice-active-dot');
        const logBody = document.getElementById('logBody');
        const clearLogsBtn = document.getElementById('clearLogsBtn');
        const activationModal = document.getElementById('activationModal');
        const activationLevelSlider = document.getElementById('activationLevel');
        const currentActivationLevelSpan = document.getElementById('currentActivationLevel');
        const cancelActivationBtn = document.getElementById('cancelActivation');
        const confirmActivationBtn = document.getElementById('confirmActivation');
        const toastContainer = document.getElementById('toastContainer');

        // Config Sliders
        const configMaxNeurons = document.getElementById('configMaxNeurons');
        const currentMaxNeurons = document.getElementById('currentMaxNeurons');
        const configNeuronSpeed = document.getElementById('configNeuronSpeed');
        const currentNeuronSpeed = document.getElementById('currentNeuronSpeed');
        const configGrowthRate = document.getElementById('configGrowthRate');
        const currentGrowthRate = document.getElementById('currentGrowthRate');
        const configConnectionDistance = document.getElementById('configConnectionDistance');
        const currentConnectionDistance = document.getElementById('currentConnectionDistance');
        const configLifespanFactor = document.getElementById('configLifespanFactor');
        const currentLifespanFactor = document.getElementById('currentLifespanFactor');
        const configMutationRate = document.getElementById('configMutationRate');
        const currentMutationRate = document.getElementById('currentMutationRate');

        // Stats Spans
        const statNeuronCount = document.getElementById('statNeuronCount');
        const statConnectionCount = document.getElementById('statConnectionCount');
        const statActiveNeurons = document.getElementById('statActiveNeurons');
        const statAverageEnergy = document.getElementById('statAverageEnergy');
        const statNetworkDensity = document.getElementById('statNetworkDensity');
        const statRecognizedPatterns = document.getElementById('statRecognizedPatterns');
        const statMemorySize = document.getElementById('statMemorySize');
        const statSystemStatus = document.getElementById('statSystemStatus');
        const statTimestamp = document.getElementById('statTimestamp');
        const refreshStatsBtn = document.getElementById('refreshStatsBtn');

        // Brain Function Buttons
        const brainFuncActivateBtn = document.getElementById('brainFuncActivateBtn');
        const brainFuncDeactivateBtn = document.getElementById('brainFuncDeactivateBtn');
        const brainFuncAddNeuronBtn = document.getElementById('brainFuncAddNeuronBtn');
        const brainFuncClearMemoryBtn = document.getElementById('brainFuncClearMemoryBtn');
        const brainFuncGoToStatsBtn = document.getElementById('brainFuncGoToStatsBtn');
        const brainFuncGoToConfigBtn = document.getElementById('brainFuncGoToConfigBtn');

        // Canvas and Neural Network Variables
        let ctx;
        let neurons = [];
        let connections = [];
        let animationFrameId;

        // Speech Recognition (Web Speech API)
        let recognition;
        let isListening = false;

        /**
         * Initializes the canvas and sets up the drawing context.
         */
        function initCanvas() {
            const container = neuralCanvas.parentElement;
            neuralCanvas.width = container.clientWidth;
            neuralCanvas.height = container.clientHeight;
            ctx = neuralCanvas.getContext('2d');
            // Add event listener for clicks to add neurons
            neuralCanvas.addEventListener('click', addNeuronOnClick);
            // Add event listeners for hover to show tooltip
            neuralCanvas.addEventListener('mousemove', showNeuronTooltip);
            neuralCanvas.addEventListener('mouseleave', hideNeuronTooltip);
        }

        /**
         * Handles window resizing to maintain canvas responsiveness.
         */
        function onWindowResize() {
            const container = neuralCanvas.parentElement;
            neuralCanvas.width = container.clientWidth;
            neuralCanvas.height = container.clientHeight;
            // Redraw content if necessary
            drawNetwork();
        }

        /**
         * Represents a single neuron in the neural network.
         * @class
         */
        class Neuron {
            constructor(x, y) {
                this.id = Date.now() + Math.random();
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * neuralConfig.neurons.speed;
                this.vy = (Math.random() - 0.5) * neuralConfig.neurons.speed;
                this.size = neuralConfig.neurons.baseSize;
                this.color = neuralConfig.neurons.colors[Math.floor(Math.random() * neuralConfig.neurons.colors.length)];
                this.lifespan = neuralConfig.neurons.lifespanFactor + Math.random() * neuralConfig.neurons.lifespanFactor; // Random lifespan
                this.age = 0;
                this.active = false;
                this.energy = 0; // Represents activity level
            }

            /**
             * Updates the neuron's position, size, and color based on its state.
             * @param {number} deltaTime - Time elapsed since last frame.
             */
            update(deltaTime) {
                if (!neuralConfig.isActive) return;

                this.x += this.vx * deltaTime;
                this.y += this.vy * deltaTime;

                // Bounce off canvas boundaries
                if (this.x < 0 || this.x > neuralCanvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > neuralCanvas.height) this.vy *= -1;

                this.age += deltaTime;
                if (this.age > this.lifespan) {
                    return true; // Indicate neuron should be removed
                }

                // Simulate energy/activity
                this.energy = Math.max(0, this.energy + (Math.random() - 0.5) * 0.1); // Fluctuate energy
                this.active = this.energy > 0.5; // Neuron is "active" if energy is above threshold

                // Update size based on activity
                this.size = this.active ? neuralConfig.neurons.activeSize : neuralConfig.neurons.baseSize;
                return false;
            }

            /**
             * Draws the neuron on the canvas.
             */
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.closePath();

                if (this.active) {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size + 2, 0, Math.PI * 2);
                    ctx.strokeStyle = 'rgba(255, 255, 0, 0.7)'; // Yellow glow
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    ctx.closePath();
                }
            }
        }

        /**
         * Represents a connection (synapse) between two neurons.
         * @class
         */
        class Connection {
            constructor(neuronA, neuronB) {
                this.neuronA = neuronA;
                this.neuronB = neuronB;
                this.active = false;
                this.opacity = neuralConfig.synapses.opacity;
                this.width = neuralConfig.synapses.width;
            }

            /**
             * Updates the connection's visual state based on neuron activity.
             */
            update() {
                if (!neuralConfig.isActive) return;
                // Activate connection if both neurons are active
                this.active = this.neuronA.active && this.neuronB.active;
                this.opacity = this.active ? neuralConfig.synapses.activeOpacity : neuralConfig.synapses.opacity;
                this.width = this.active ? neuralConfig.synapses.activeWidth : neuralConfig.synapses.width;
            }

            /**
             * Draws the connection on the canvas.
             */
            draw() {
                ctx.beginPath();
                ctx.moveTo(this.neuronA.x, this.neuronA.y);
                ctx.lineTo(this.neuronB.x, this.neuronB.y);
                ctx.strokeStyle = `rgba(204, 204, 204, ${this.opacity})`; // Grey with varying opacity
                ctx.lineWidth = this.width;
                ctx.stroke();
                ctx.closePath();
            }
        }

        /**
         * Adds a new neuron to the network at a random position or at specified coordinates.
         */
        function addNeuron(x = null, y = null) {
            if (neurons.length >= neuralConfig.neurons.maxCount) {
                showToast('Capacité maximale de neurones atteinte.', 'warning');
                return;
            }

            if (x === null || y === null) {
                x = Math.random() * neuralCanvas.width;
                y = Math.random() * neuralCanvas.height;
            }
            const newNeuron = new Neuron(x, y);
            neurons.push(newNeuron);
            logActivity(`[Déploiement] Nouveau neurone #${newNeuron.id.toFixed(0)} déployé.`);
            updateCounts();
            showToast('Neurone déployé !', 'success');
        }

        /**
         * Event handler for adding a neuron on canvas click.
         * @param {MouseEvent} event - The click event.
         */
        function addNeuronOnClick(event) {
            if (!neuralConfig.isActive) {
                showToast('Le système n\'est pas actif. Veuillez le démarrer.', 'error');
                return;
            }
            const rect = neuralCanvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            addNeuron(x, y);
        }

        /**
         * Connects newly added neurons to existing ones if they are within connection distance.
         */
        function updateConnections() {
            connections = []; // Clear existing connections for simplicity

            for (let i = 0; i < neurons.length; i++) {
                for (let j = i + 1; j < neurons.length; j++) {
                    const n1 = neurons[i];
                    const n2 = neurons[j];
                    const distance = Math.sqrt(Math.pow(n1.x - n2.x, 2) + Math.pow(n1.y - n2.y, 2));

                    if (distance < neuralConfig.connectionDistance) {
                        connections.push(new Connection(n1, n2));
                    }
                }
            }
            updateCounts();
        }

        /**
         * The main animation loop for the neural network visualization.
         */
        function animateNetwork() {
            animationFrameId = requestAnimationFrame(animateNetwork);

            ctx.clearRect(0, 0, neuralCanvas.width, neuralCanvas.height); // Clear canvas

            const deltaTime = 1; // Simulate a fixed time step for simplicity

            // Update and draw neurons
            const neuronsToRemove = [];
            neurons.forEach((neuron, index) => {
                if (neuron.update(deltaTime)) {
                    neuronsToRemove.push(index);
                }
                neuron.draw();
            });

            // Remove dying neurons
            for (let i = neuronsToRemove.length - 1; i >= 0; i--) {
                neurons.splice(neuronsToRemove[i], 1);
            }

            // Update and draw connections
            updateConnections(); // Re-create connections each frame for simplicity
            connections.forEach(connection => {
                connection.update();
                connection.draw();
            });
        }

        /**
         * Updates the neuron and synapse counts in the UI.
         */
        function updateCounts() {
            neuronCountSpan.textContent = neurons.length;
            synapseCountSpan.textContent = connections.length;
            statNeuronCount.textContent = neurons.length;
            statConnectionCount.textContent = connections.length;
            statActiveNeurons.textContent = neurons.filter(n => n.active).length;
            const totalEnergy = neurons.reduce((sum, n) => sum + n.energy, 0);
            statAverageEnergy.textContent = (neurons.length > 0 ? (totalEnergy / neurons.length).toFixed(2) : '0.00');
            statNetworkDensity.textContent = (neurons.length > 1 ? (connections.length / (neurons.length * (neurons.length - 1) / 2) * 100).toFixed(2) : '0.00') + '%';
            statSystemStatus.textContent = neuralConfig.isActive ? 'Opérationnel' : 'Hors Ligne';
            statTimestamp.textContent = new Date().toLocaleTimeString();
        }

        /**
         * Updates the system health bar and text.
         */
        function updateSystemHealth() {
            const health = neuralConfig.systemHealth;
            systemHealthBar.style.width = `${health}%`;
            systemHealthText.textContent = `${health}%`;

            systemHealthBar.classList.remove('low', 'medium');
            if (health < 30) {
                systemHealthBar.classList.add('low');
                systemHealthText.classList.add('text-red-500'); // Tailwind red
                systemHealthText.classList.remove('text-primary', 'text-yellow-500');
            } else if (health < 60) {
                systemHealthBar.classList.add('medium');
                systemHealthText.classList.add('text-yellow-500'); // Tailwind yellow
                systemHealthText.classList.remove('text-primary', 'text-red-500');
            } else {
                systemHealthText.classList.add('text-primary');
                systemHealthText.classList.remove('text-yellow-500', 'text-red-500');
            }
        }

        /**
         * Manages the replication progress bar and triggers neuron replication.
         */
        function handleReplicationProgress() {
            if (!neuralConfig.isActive) return;

            neuralConfig.replicationProgress += 1; // Increment progress
            if (neuralConfig.replicationProgress > 100) {
                // Trigger replication
                const numToReplicate = Math.floor(neuralConfig.growthRate / 10); // Add a few neurons at once
                for (let i = 0; i < numToReplicate; i++) {
                    addNeuron();
                }
                logActivity(`[Réplication] ${numToReplicate} neurones répliqués.`);
                neuralConfig.replicationProgress = 0; // Reset progress
            }
            replicationProgress.style.width = `${neuralConfig.replicationProgress}%`;
        }

        /**
         * Displays a temporary tooltip with neuron information on hover.
         * @param {MouseEvent} event - The mouse move event.
         */
        function showNeuronTooltip(event) {
            const rect = neuralCanvas.getBoundingClientRect();
            const mouseX = event.clientX - rect.left;
            const mouseY = event.clientY - rect.top;

            let hoveredNeuron = null;
            for (const neuron of neurons) {
                const distance = Math.sqrt(Math.pow(mouseX - neuron.x, 2) + Math.pow(mouseY - neuron.y, 2));
                if (distance < neuron.size + 5) { // Add some padding for easier hover
                    hoveredNeuron = neuron;
                    break;
                }
            }

            if (hoveredNeuron) {
                neuronInfoTooltip.classList.add('visible');
                neuronInfoTooltip.style.left = `${event.clientX + 10}px`;
                neuronInfoTooltip.style.top = `${event.clientY - 10}px`;
                neuronInfoTooltip.innerHTML = `
                    <strong>ID:</strong> ${hoveredNeuron.id.toFixed(0).slice(-4)}<br>
                    <strong>Actif:</strong> ${hoveredNeuron.active ? 'Oui' : 'Non'}<br>
                    <strong>Énergie:</strong> ${hoveredNeuron.energy.toFixed(2)}<br>
                    <strong>Âge:</strong> ${(hoveredNeuron.age / 60).toFixed(1)}s
                `;
            } else {
                neuronInfoTooltip.classList.remove('visible');
            }
        }

        /**
         * Hides the neuron information tooltip.
         */
        function hideNeuronTooltip() {
            neuronInfoTooltip.classList.remove('visible');
        }

        /**
         * Adds a message to the chat interface.
         * @param {string} sender - 'user' or 'ai'.
         * @param {string} message - The message content.
         */
        function addChatMessage(sender, message) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-message', sender, 'rounded-lg', 'mb-2', 'p-3');
            messageDiv.innerHTML = `<p class="text-sm">${sender === 'user' ? 'Vous' : 'IA'} : ${message}</p>`;
            chatBody.appendChild(messageDiv);
            chatBody.scrollTop = chatBody.scrollHeight; // Scroll to bottom
        }

        /**
         * Displays a temporary toast notification.
         * @param {string} message - The message to display.
         * @param {string} type - 'success', 'error', or 'info'.
         */
        function showToast(message, type = 'info') {
            const toastDiv = document.createElement('div');
            toastDiv.classList.add('toast', type, 'p-4', 'rounded-lg', 'shadow-lg', 'mb-3');
            toastDiv.textContent = message;
            toastContainer.appendChild(toastDiv);

            setTimeout(() => {
                toastDiv.classList.add('fade-out');
                toastDiv.addEventListener('animationend', () => toastDiv.remove());
            }, 3000); // Toast disappears after 3 seconds
        }

        /**
         * Adds an entry to the activity log.
         * @param {string} message - The log message.
         */
        function logActivity(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('p');
            logEntry.classList.add('mb-1');
            logEntry.innerHTML = `<span class="text-gray-500">[${timestamp}]</span> ${message}`;
            logBody.appendChild(logEntry);
            logBody.scrollTop = logBody.scrollHeight; // Scroll to bottom
        }

        // Event Listeners

        // Sidebar toggle for mobile
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Navigation item click handler
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                // Remove active from all nav items
                navItems.forEach(nav => nav.classList.remove('active'));
                // Add active to clicked item
                this.classList.add('active');

                // Hide all content sections
                contentSections.forEach(section => section.classList.remove('active'));
                // Show the target content section
                const targetId = this.dataset.targetContent;
                document.getElementById(targetId).classList.add('active');

                // Hide sidebar on mobile after selection
                if (window.innerWidth < 768) {
                    sidebar.classList.remove('open');
                }
            });
        });

        // Start/Deactivate System Buttons
        startBtn.addEventListener('click', () => {
            activationModal.classList.remove('hidden');
        });

        cancelActivationBtn.addEventListener('click', () => {
            activationModal.classList.add('hidden');
        });

        confirmActivationBtn.addEventListener('click', () => {
            neuralConfig.isActive = true;
            neuralConfig.systemHealth = 100;
            neuralConfig.growthRate = activationLevelSlider.value / 100 * 50 + 10; // Scale growth based on activation level
            updateSystemHealth();
            startBtn.classList.add('hidden');
            deactivateBtn.classList.remove('hidden');
            activationModal.classList.add('hidden');
            logActivity(`[Système] NeuraX-Ultime activé au niveau ${activationLevelSlider.value}%.`);
            showToast('NeuraX-Ultime activé !', 'success');

            // Initial neuron deployment
            for (let i = 0; i < 50; i++) { // Deploy initial 50 neurons
                addNeuron();
            }
        });

        deactivateBtn.addEventListener('click', () => {
            neuralConfig.isActive = false;
            neuralConfig.systemHealth = 0;
            updateSystemHealth();
            deactivateBtn.classList.add('hidden');
            startBtn.classList.remove('hidden');
            logActivity('[Système] NeuraX-Ultime désactivé.');
            showToast('NeuraX-Ultime désactivé.', 'error');
            // Clear neurons and connections
            neurons = [];
            connections = [];
            updateCounts();
        });

        // Activation Level Slider in Modal
        activationLevelSlider.addEventListener('input', () => {
            currentActivationLevelSpan.textContent = activationLevelSlider.value;
        });

        // Chat functionality
        sendBtn.addEventListener('click', () => {
            const message = chatInput.value.trim();
            if (message) {
                addChatMessage('user', message);
                chatInput.value = '';
                // Simulate AI response
                setTimeout(() => {
                    addChatMessage('ai', `Message reçu. Traitement de la requête "${message}" en cours.`);
                    logActivity(`[Comms] Requête IA : "${message.substring(0, 30)}..."`);
                }, 1000);
            }
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendBtn.click();
            }
        });

        // Voice input (Web Speech API)
        voiceBtn.addEventListener('click', () => {
            if (!('webkitSpeechRecognition' in window)) {
                showToast('API de reconnaissance vocale non supportée par ce navigateur.', 'error');
                return;
            }

            if (!recognition) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false; // Listen for a single phrase
                recognition.interimResults = false; // Only return final results
                recognition.lang = 'fr-FR'; // French

                recognition.onstart = () => {
                    isListening = true;
                    voiceActiveDot.classList.remove('hidden');
                    showToast('Écoute active...', 'info');
                };

                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    chatInput.value = transcript;
                    sendBtn.click();
                };

                recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    showToast(`Erreur vocale: ${event.error}`, 'error');
                    isListening = false;
                    voiceActiveDot.classList.add('hidden');
                };

                recognition.onend = () => {
                    isListening = false;
                    voiceActiveDot.classList.add('hidden');
                    showToast('Écoute terminée.', 'info');
                };
            }

            if (isListening) {
                recognition.stop();
            } else {
                recognition.start();
            }
        });

        // Clear Logs Button
        clearLogsBtn.addEventListener('click', () => {
            logBody.innerHTML = '<p class="text-gray-500"><em>[00:00:01] Journal purgé.</em></p>';
            showToast('Journal d\'activité purgé.', 'info');
        });

        // Config Sliders Event Listeners
        configMaxNeurons.addEventListener('input', () => {
            neuralConfig.neurons.maxCount = parseInt(configMaxNeurons.value);
            currentMaxNeurons.textContent = neuralConfig.neurons.maxCount;
        });
        configNeuronSpeed.addEventListener('input', () => {
            neuralConfig.neurons.speed = parseFloat(configNeuronSpeed.value);
            currentNeuronSpeed.textContent = neuralConfig.neurons.speed.toFixed(1);
        });
        configGrowthRate.addEventListener('input', () => {
            neuralConfig.growthRate = parseInt(configGrowthRate.value);
            currentGrowthRate.textContent = neuralConfig.growthRate;
        });
        configConnectionDistance.addEventListener('input', () => {
            neuralConfig.connectionDistance = parseInt(configConnectionDistance.value);
            currentConnectionDistance.textContent = neuralConfig.connectionDistance;
            updateConnections(); // Recalculate connections immediately
        });
        configLifespanFactor.addEventListener('input', () => {
            neuralConfig.neurons.lifespanFactor = parseInt(configLifespanFactor.value);
            currentLifespanFactor.textContent = neuralConfig.neurons.lifespanFactor;
        });
        configMutationRate.addEventListener('input', () => {
            neuralConfig.neurons.mutationRate = parseFloat(configMutationRate.value);
            currentMutationRate.textContent = neuralConfig.neurons.mutationRate.toFixed(3);
        });

        // Stats Refresh Button
        refreshStatsBtn.addEventListener('click', updateCounts);

        // Brain Function Buttons (navigate to sections)
        brainFuncActivateBtn.addEventListener('click', () => startBtn.click()); // Reuse existing start logic
        brainFuncDeactivateBtn.addEventListener('click', () => deactivateBtn.click()); // Reuse existing deactivate logic
        brainFuncAddNeuronBtn.addEventListener('click', () => addNeuron());
        brainFuncClearMemoryBtn.addEventListener('click', () => {
            // Placeholder for memory clearing logic
            statRecognizedPatterns.textContent = '0';
            statMemorySize.textContent = '0 KB';
            logActivity('[Protocole] Mémoire des motifs purgée.');
            showToast('Mémoire des motifs purgée.', 'success');
        });
        brainFuncGoToStatsBtn.addEventListener('click', () => {
            document.querySelector('.nav-item[data-target-content="statsContent"]').click();
        });
        brainFuncGoToConfigBtn.addEventListener('click', () => {
            document.querySelector('.nav-item[data-target-content="configContent"]').click();
        });

        // External Services Buttons (conceptual interaction)
        document.querySelectorAll('.external-service-btn').forEach(button => {
            button.addEventListener('click', function() {
                const serviceName = this.dataset.service;
                logActivity(`[Intégration] Tentative de connexion à ${serviceName}...`);
                showToast(`Connexion à ${serviceName} initiée (conceptuel).`, 'info');
            });
        });


        // Initialize on window load
        window.onload = function() {
            initCanvas();
            animateNetwork(); // Start the animation loop
            onWindowResize(); // Set initial canvas size
            window.addEventListener('resize', onWindowResize); // Handle resize events
            logActivity('[Système] NeuraX-Ultime : Initialisation du système.');
            updateSystemHealth(); // Set initial health display
            updateCounts(); // Set initial counts
            setInterval(handleReplicationProgress, 50); // Update replication progress every 50ms
            setInterval(() => { // Simulate system health fluctuations
                if (neuralConfig.isActive) {
                    neuralConfig.systemHealth = Math.max(0, Math.min(100, neuralConfig.systemHealth + (Math.random() - 0.5) * 5));
                    updateSystemHealth();
                    if (neuralConfig.systemHealth < 20) {
                        showToast('Avertissement : Santé du système critique !', 'error');
                        logActivity('[ALERTE] Santé du système critique !');
                    }
                }
            }, 5000); // Update health every 5 seconds
        };
    </script>
</body>
</html>
import React, { useState, useEffect } from 'react';

// Main App component
function App() {
  // State variables for the application flow
  const [currentStep, setCurrentStep] = useState(0); // 0: Intro, 1: Define Need, 2: Choose Type, 3: Generate, 4: Display Code
  const [problem, setProblem] = useState('');
  const [events, setEvents] = useState('');
  const [actions, setActions] = useState('');
  const [users, setUsers] = useState('');
  const [integrationType, setIntegrationType] = useState(''); // 'GitHub App', 'GitHub Actions Workflow', 'Custom Action'
  const [generatedCode, setGeneratedCode] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState('');

  // Function to navigate to the next step
  const nextStep = () => {
    setCurrentStep(currentStep + 1);
    setError(''); // Clear any previous errors
  };

  // Function to navigate to the previous step
  const prevStep = () => {
    setCurrentStep(currentStep - 1);
    setError(''); // Clear any previous errors
  };

  // Function to handle code generation using the LLM
  const generateCode = async () => {
    setIsLoading(true);
    setError('');
    setGeneratedCode('');

    let prompt = `Génère un exemple de code pour une intégration GitHub basée sur les spécifications suivantes:\n\n`;
    prompt += `Type d'intégration: ${integrationType}\n`;
    prompt += `Problème à résoudre: ${problem}\n`;
    prompt += `Événements déclencheurs: ${events}\n`;
    prompt += `Actions à effectuer: ${actions}\n`;
    prompt += `Utilisateurs cibles: ${users}\n\n`;

    // Add specific instructions based on integration type for better generation
    if (integrationType === 'GitHub App') {
      prompt += `Le code doit être une structure de base pour une GitHub App en Node.js (Probot ou Octokit.js) qui écoute les webhooks spécifiés et effectue les actions. Inclure des commentaires pour expliquer chaque partie.\n`;
    } else if (integrationType === 'GitHub Actions Workflow') {
      prompt += `Le code doit être un fichier YAML pour un workflow GitHub Actions (.github/workflows/main.yml) qui se déclenche sur les événements spécifiés et exécute les actions. Inclure des commentaires pour expliquer chaque étape.\n`;
    } else if (integrationType === 'Action personnalisée') {
      prompt += `Le code doit être une action personnalisée pour GitHub Actions. Fournir le fichier action.yml et un script JavaScript (index.js) ou un Dockerfile simple qui effectue les actions. Inclure des commentaires pour expliquer le code.\n`;
    }

    prompt += `Le code doit être complet et prêt à être utilisé comme point de départ.`;

    try {
      // LLM API call
      let chatHistory = [];
      chatHistory.push({ role: "user", parts: [{ text: prompt }] });
      const payload = { contents: chatHistory };
      const apiKey = ""; // API key will be provided by the environment
      const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

      const response = await fetch(apiUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      const result = await response.json();

      if (result.candidates && result.candidates.length > 0 &&
          result.candidates[0].content && result.candidates[0].content.parts &&
          result.candidates[0].content.parts.length > 0) {
        const text = result.candidates[0].content.parts[0].text;
        setGeneratedCode(text);
        setCurrentStep(4); // Move to display code step
      } else {
        setError("Impossible de générer le code. Veuillez réessayer.");
        console.error("Unexpected API response structure:", result);
      }
    } catch (err) {
      setError(`Erreur lors de la génération du code: ${err.message}. Veuillez vérifier votre connexion ou réessayer.`);
      console.error("Error during code generation:", err);
    } finally {
      setIsLoading(false);
    }
  };

  // Render different steps based on currentStep state
  const renderStep = () => {
    switch (currentStep) {
      case 0:
        return (
          <div className="text-center">
            <h2 className="text-2xl font-bold mb-4">Bienvenue au Générateur de Code pour Intégrations GitHub !</h2>
            <p className="mb-6 text-lg">
              Cet outil vous aidera à concevoir et à générer le code de base pour vos intégrations GitHub, en suivant le plan que nous avons établi.
            </p>
            <button
              onClick={nextStep}
              className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105"
            >
              Commencer
            </button>
          </div>
        );
      case 1:
        return (
          <div className="max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md">
            <h2 className="text-2xl font-bold mb-6 text-center">Étape 1: Définir le besoin et le cas d'utilisation</h2>
            <div className="mb-4">
              <label htmlFor="problem" className="block text-gray-700 text-sm font-bold mb-2">
                Quel problème l'intégration va-t-elle résoudre ?
              </label>
              <textarea
                id="problem"
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline h-24 resize-y"
                value={problem}
                onChange={(e) => setProblem(e.target.value)}
                placeholder="Ex: Automatiser la labellisation des issues, synchroniser des projets avec un outil externe..."
              ></textarea>
            </div>
            <div className="mb-4">
              <label htmlFor="events" className="block text-gray-700 text-sm font-bold mb-2">
                Quels événements GitHub déclencheront l'intégration ?
              </label>
              <input
                type="text"
                id="events"
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                value={events}
                onChange={(e) => setEvents(e.target.value)}
                placeholder="Ex: issues.opened, pull_request.closed, push"
              />
            </div>
            <div className="mb-4">
              <label htmlFor="actions" className="block text-gray-700 text-sm font-bold mb-2">
                Quelles actions l'intégration doit-elle effectuer sur GitHub ou en dehors ?
              </label>
              <textarea
                id="actions"
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline h-24 resize-y"
                value={actions}
                onChange={(e) => setActions(e.target.value)}
                placeholder="Ex: Créer un commentaire, fermer une pull request, appeler une API externe..."
              ></textarea>
            </div>
            <div className="mb-6">
              <label htmlFor="users" className="block text-gray-700 text-sm font-bold mb-2">
                Qui utilisera cette intégration ?
              </label>
              <input
                type="text"
                id="users"
                className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                value={users}
                onChange={(e) => setUsers(e.target.value)}
                placeholder="Ex: Utilisateurs individuels, équipes, organisations entières"
              />
            </div>
            <div className="flex justify-between">
              <button
                onClick={prevStep}
                className="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out"
              >
                Précédent
              </button>
              <button
                onClick={nextStep}
                disabled={!problem || !events || !actions || !users}
                className={`bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out ${
                  (!problem || !events || !actions || !users) ? 'opacity-50 cursor-not-allowed' : 'transform hover:scale-105'
                }`}
              >
                Suivant
              </button>
            </div>
          </div>
        );
      case 2:
        return (
          <div className="max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md">
            <h2 className="text-2xl font-bold mb-6 text-center">Étape 2: Choisir le bon type d'intégration</h2>
            <p className="mb-4 text-gray-700">Sélectionnez le type d'intégration qui convient le mieux à votre besoin :</p>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <button
                onClick={() => setIntegrationType('GitHub App')}
                className={`p-4 rounded-lg border-2 ${
                  integrationType === 'GitHub App' ? 'border-blue-600 bg-blue-50' : 'border-gray-300 hover:border-blue-400'
                } transition duration-300 ease-in-out text-left`}
              >
                <h3 className="font-bold text-lg mb-2">GitHub App</h3>
                <p className="text-sm text-gray-600">Pour des applications durables, authentification fine, interaction complexe avec l'API, ou fonctionnement sur plusieurs dépôts/organisations.</p>
              </button>
              <button
                onClick={() => setIntegrationType('GitHub Actions Workflow')}
                className={`p-4 rounded-lg border-2 ${
                  integrationType === 'GitHub Actions Workflow' ? 'border-blue-600 bg-blue-50' : 'border-gray-300 hover:border-blue-400'
                } transition duration-300 ease-in-out text-left`}
              >
                <h3 className="font-bold text-lg mb-2">GitHub Actions Workflow</h3>
                <p className="text-sm text-gray-600">Pour l'automatisation spécifique à un dépôt, déclenchée par des événements standard de GitHub.</p>
              </button>
              <button
                onClick={() => setIntegrationType('Action personnalisée')}
                className={`p-4 rounded-lg border-2 ${
                  integrationType === 'Action personnalisée' ? 'border-blue-600 bg-blue-50' : 'border-gray-300 hover:border-blue-400'
                } transition duration-300 ease-in-out text-left`}
              >
                <h3 className="font-bold text-lg mb-2">Action personnalisée</h3>
                <p className="text-sm text-gray-600">Pour une logique réutilisable à partager avec d'autres workflows ou utilisateurs.</p>
              </button>
            </div>
            <div className="flex justify-between">
              <button
                onClick={prevStep}
                className="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out"
              >
                Précédent
              </button>
              <button
                onClick={nextStep}
                disabled={!integrationType}
                className={`bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out ${
                  !integrationType ? 'opacity-50 cursor-not-allowed' : 'transform hover:scale-105'
                }`}
              >
                Suivant
              </button>
            </div>
          </div>
        );
      case 3:
        return (
          <div className="max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md text-center">
            <h2 className="text-2xl font-bold mb-6">Prêt à générer le code ?</h2>
            <p className="mb-4 text-gray-700">
              Basé sur vos sélections, je vais maintenant générer le code de base pour votre intégration GitHub.
            </p>
            <p className="mb-6 text-gray-700 font-semibold">
              Type sélectionné: <span className="text-blue-600">{integrationType}</span>
            </p>
            {error && <p className="text-red-500 mb-4">{error}</p>}
            <div className="flex justify-between">
              <button
                onClick={prevStep}
                className="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out"
              >
                Précédent
              </button>
              <button
                onClick={generateCode}
                disabled={isLoading}
                className={`bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out ${
                  isLoading ? 'opacity-50 cursor-not-allowed' : 'transform hover:scale-105'
                }`}
              >
                {isLoading ? (
                  <div className="flex items-center justify-center">
                    <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                      <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                      <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Génération...
                  </div>
                ) : (
                  'Générer le code'
                )}
              </button>
            </div>
          </div>
        );
      case 4:
        return (
          <div className="max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md">
            <h2 className="text-2xl font-bold mb-6 text-center">Code généré pour votre intégration GitHub</h2>
            {error && <p className="text-red-500 mb-4">{error}</p>}
            <div className="bg-gray-800 text-white p-4 rounded-lg overflow-x-auto mb-6">
              <pre><code>{generatedCode || 'Aucun code généré.'}</code></pre>
            </div>
            <div className="flex justify-between">
              <button
                onClick={() => setCurrentStep(0)} // Restart from the beginning
                className="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out"
              >
                Recommencer
              </button>
              <button
                onClick={() => {
                  // Copy to clipboard functionality
                  const el = document.createElement('textarea');
                  el.value = generatedCode;
                  document.body.appendChild(el);
                  el.select();
                  document.execCommand('copy');
                  document.body.removeChild(el);
                  alert('Code copié dans le presse-papiers !'); // Using alert for simplicity, could be a custom modal
                }}
                className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-300 ease-in-out transform hover:scale-105"
              >
                Copier le code
              </button>
            </div>
          </div>
        );
      default:
        return null;
    }
  };

  return (
    <div className="min-h-screen bg-gray-100 flex items-center justify-center p-4 font-sans">
      <div className="w-full">
        {renderStep()}
      </div>
    </div>
  );
}

export default App;
